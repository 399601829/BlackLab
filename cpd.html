<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from org.apache.maven.plugins:maven-pmd-plugin:3.12.0:cpd at 2020-01-10
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200110" />
    <meta http-equiv="Content-Language" content="en" />
    <title>BlackLab &#x2013; CPD Results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Nunito:300' rel='stylesheet' type='text/css' />
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="http://www.ivdnt.org/" id="bannerLeft"><img src="images/logo_2_ivd-nt_transparant.png"  alt="Dutch Language Institute (INT)"/></a></div>
        <div class="pull-right"><a href="BlackLab/" id="bannerRight"><img src="images/logo-blacklab.png"  alt="BlackLab"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="http://www.ivdnt.org/" class="externalLink" title="INT">INT</a><span class="divider">/</span></li>
      <li class=""><a href="index.html" title="BlackLab">BlackLab</a><span class="divider">/</span></li>
    <li class="active ">CPD Results</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2020-01-10</li>
          <li id="projectVersion" class="pull-right">Version: 2.0.0</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">BlackLab</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="learn.html" title="Learn"><span class="icon-chevron-down"></span>Learn</a>
    <ul class="nav nav-list">
    <li><a href="getting-started.html" title="Getting Started"><span class="none"></span>Getting Started</a></li>
    <li><a href="corpus-query-language.html" title="Corpus Query Language"><span class="none"></span>Corpus Query Language</a></li>
    <li><a href="blacklab-server-overview.html" title="BlackLab Server overview"><span class="none"></span>BlackLab Server overview</a></li>
    <li><a href="configuration-files.html" title="Configuration files"><span class="none"></span>Configuration files</a></li>
    <li><a href="blacklab-server-different-languages.html" title="Using BlackLab Server from different languages"><span class="none"></span>Using BlackLab Server from different languages</a></li>
    <li><a href="indexing-with-blacklab.html" title="Indexing with BlackLab"><span class="none"></span>Indexing with BlackLab</a></li>
    <li><a href="add-input-format.html" title="Add An Input Format"><span class="none"></span>Add An Input Format</a></li>
    <li><a href="improve-search-speed.html" title="Improve Search Speed"><span class="none"></span>Improve Search Speed</a></li>
    <li><a href="apidocs/index.html" title="API reference"><span class="none"></span>API reference</a></li>
    <li><a href="file-formats.html" title="File formats"><span class="none"></span>File formats</a></li>
    </ul>
</li>
    <li><a href="downloads.html" title="Downloads"><span class="none"></span>Downloads</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="changelog.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li><a href="roadmap.html" title="Road Map"><span class="none"></span>Road Map</a></li>
    <li><a href="newsletter.html" title="Newsletter"><span class="none"></span>Newsletter</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-down"></span>Project Reports</a>
    <ul class="nav nav-list">
    <li><a href="surefire-report.html" title="Surefire Report"><span class="none"></span>Surefire Report</a></li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="xref/index.html" title="Source Xref"><span class="none"></span>Source Xref</a></li>
    <li><a href="xref-test/index.html" title="Test Source Xref"><span class="none"></span>Test Source Xref</a></li>
    <li><a href="findbugs.html" title="FindBugs"><span class="none"></span>FindBugs</a></li>
    <li class="active"><a href="#"><span class="none"></span>CPD</a></li>
    <li><a href="pmd.html" title="PMD"><span class="none"></span>PMD</a></li>
    <li><a href="checkstyle.html" title="Checkstyle"><span class="none"></span>Checkstyle</a></li>
    <li><a href="taglist.html" title="Tag List"><span class="none"></span>Tag List</a></li>
    <li><a href="dependency-updates-report.html" title="Dependency Updates Report"><span class="none"></span>Dependency Updates Report</a></li>
    <li><a href="plugin-updates-report.html" title="Plugin Updates Report"><span class="none"></span>Plugin Updates Report</a></li>
    </ul>
</li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<div class="section">
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.13.0.</p></div>
<div class="section">
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/results/HitsFromQuery.java</td>
<td><a href="./xref/nl/inl/blacklab/search/results/HitsFromQuery.html#L100">100</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/results/HitsFromQueryParallel.java</td>
<td><a href="./xref/nl/inl/blacklab/search/results/HitsFromQueryParallel.html#L103">103</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    protected HitsFromQuery(QueryInfo queryInfo, BLSpanQuery sourceQuery, SearchSettings searchSettings) throws WildcardTermTooBroad {
        super(queryInfo);
        this.searchSettings = searchSettings;
        this.maxStats = new MaxStats();
        hitsCounted = 0;
        hitQueryContext = new HitQueryContext();
        try {
            BlackLabIndex index = queryInfo.index();
            IndexReader reader = index.reader();
            
            // Override FI match threshold? (debug use only!)
            long oldFiMatchValue = ClauseCombinerNfa.getNfaThreshold();
            if (searchSettings.fiMatchFactor() != -1) {
                queryInfo.log(LogLevel.OPT, &quot;setting NFA threshold for this query to &quot; + searchSettings.fiMatchFactor());
                ClauseCombinerNfa.setNfaThreshold(searchSettings.fiMatchFactor());
            }
            
            sourceQuery.setQueryInfo(queryInfo);
            queryInfo.log(LogLevel.EXPLAIN, &quot;Query before optimize()/rewrite(): &quot; + sourceQuery);
            
            BLSpanQuery optimize = sourceQuery.optimize(reader);
            queryInfo.log(LogLevel.EXPLAIN, &quot;Query after optimize(): &quot; + optimize);

            BLSpanQuery spanQuery = optimize.rewrite(reader);
            queryInfo.log(LogLevel.EXPLAIN, &quot;Query after rewrite(): &quot; + spanQuery);
            
            // Restore previous FI match threshold
            if (searchSettings.fiMatchFactor() != -1) {
                ClauseCombinerNfa.setNfaThreshold(oldFiMatchValue);
            }

            //System.err.println(spanQuery);
            termContexts = new HashMap&lt;&gt;();
            Set&lt;Term&gt; terms = new HashSet&lt;&gt;();
            spanQuery = BLSpanQuery.ensureSortedUnique(spanQuery);
            weight = spanQuery.createWeight(index.searcher(), false);
            weight.extractTerms(terms);
            for (Term term : terms) {
                try {
                    threadPauser.waitIfPaused();
                } catch (InterruptedException e) {
                    throw new InterruptedSearch(e);
                }
                termContexts.put(term, TermContext.build(reader.getContext(), term));
            }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/index/DocIndexerPlainTextBasic.java</td>
<td><a href="./xref/nl/inl/blacklab/index/DocIndexerPlainTextBasic.html#L178">178</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/index/DocIndexerXmlHandlers.java</td>
<td><a href="./xref/nl/inl/blacklab/index/DocIndexerXmlHandlers.html#L107">107</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            int lastValuePos = 0;
            for (AnnotationWriter prop : contentsField.annotationWriters()) {
                if (prop.lastValuePosition() &gt; lastValuePos)
                    lastValuePos = prop.lastValuePosition();
            }

            // Make sure we always have one more token than the number of
            // words, so there's room for any tags after the last word, and we
            // know we should always skip the last token when matching.
            if (propMain.lastValuePosition() == lastValuePos)
                lastValuePos++;

            // Add empty values to all lagging properties
            for (AnnotationWriter prop : contentsField.annotationWriters()) {
                while (prop.lastValuePosition() &lt; lastValuePos) {
                    prop.addValue(&quot;&quot;);
                    if (prop.hasPayload())
                        prop.addPayload(null);
                    if (prop == propMain) {
                        contentsField.addStartChar(getCharacterPosition());
                        contentsField.addEndChar(getCharacterPosition());
                    }
                }
            }

            // Finish storing the document in the document store (parts of it
            // may already have been written because we write in chunks to save memory),
            // retrieve the content id, and store that in Lucene.
            // (Note that we do this after adding the dummy token, so the character
            // positions for the dummy token still make (some) sense)
            int contentId = storeCapturedContent();
            currentLuceneDoc
                    .add(new IntField(AnnotatedFieldNameUtil.contentIdField(contentsField.name()), contentId, Store.YES));

            // Store the different properties of the annotated contents field that
            // were gathered in lists while parsing.
            contentsField.addToLuceneDoc(currentLuceneDoc);

            // Add field with all its annotations to the forward index
            addToForwardIndex(contentsField);

            // If there's an external metadata fetcher, call it now so it can
            // add the metadata for this document and (optionally) store the
            // metadata document in the content store (and the corresponding id in the
            // Lucene doc)
            MetadataFetcher m = getMetadataFetcher();
            if (m != null) {
                m.addMetadata();
            }

            addMetadataToDocument();

            try {
                // Add Lucene doc to indexer
                docWriter.add(currentLuceneDoc);
            } catch (Exception e) {
                throw BlackLabRuntimeException.wrap(e);
            }

            // Report progress
            reportCharsProcessed();
            reportTokensProcessed();

            docWriter.listener().documentDone(documentName);

            // Reset contents field for next document
            contentsField.clear(true);
            currentLuceneDoc = null;

            // Stop if required
            if (!docWriter.continueIndexing())
                throw new MaxDocsReached();

        }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/fimatch/NfaStateAnd.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateAnd.html#L106">106</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/fimatch/NfaStateOr.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateOr.html#L107">107</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        }
        return true;
    }

    @Override
    public int hitsLengthMin(Set&lt;NfaState&gt; statesVisited) {
        int hitLengthMin = Integer.MAX_VALUE;
        if (statesVisited.contains(this)) {
            // We've found a cycle. Stop processing, and just return the
            // &quot;safest&quot; (least-guarantee) answer. In this case: the smallest
            // hit might be 0 long.
            return 0;
        }
        statesVisited.add(this);
        for (NfaState nextState : nextStates) {
            int i = nextState.hitsLengthMin(statesVisited);
            if (i &lt; hitLengthMin)
                hitLengthMin = i;
        }
        return hitLengthMin;
    }

    @Override
    public int hitsLengthMax(Set&lt;NfaState&gt; statesVisited) {
        int hitLengthMax = 0;
        if (statesVisited.contains(this)) {
            // We've found a cycle. Stop processing, and just return the
            // &quot;safest&quot; (least-guarantee) answer. In this case: the largest
            // hit might be &quot;infinitely&quot; large.
            return Integer.MAX_VALUE;
        }
        statesVisited.add(this);
        for (NfaState nextState : nextStates) {
            int i = nextState.hitsLengthMax(statesVisited);
            if (i &gt; hitLengthMax)
                hitLengthMax = i;
        }
        return hitLengthMax;
    }

    @Override
    protected String dumpInternal(Map&lt;NfaState, Integer&gt; stateNrs) {
        StringBuilder b = new StringBuilder();
        for (NfaState s : nextStates) {
            if (b.length() &gt; 0)
                b.append(&quot;,&quot;);
            b.append(dump(s, stateNrs));
        }
        return &quot;AND(&quot; + b.toString() + &quot;)&quot;;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L167">167</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerWhiteLab2.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerWhiteLab2.html#L229">229</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                if (numPosAnnotations == 2 &amp;&amp; isFrog ||
                        numPosAnnotations == 1 &amp;&amp; isSetLess) {
                    // If there were 2 pos annotation meta declarations,
                    // we should use the frog ones; if only 1, the ones
                    // without a &quot;set&quot; attribute.
                    pos = attributes.getValue(&quot;class&quot;);
                    if (pos == null)
                        pos = &quot;&quot;;
                    // Capture the features inside this pos element (and add the head PoS now)
                    capturePosFeatures = true;
                    posFeatures.clear();
                    String posHead = pos.contains(&quot;(&quot;) ? pos.substring(0, pos.indexOf('(')).trim() : pos;
                    posFeatures.put(&quot;head&quot;, posHead);
                }
            }

            @Override
            public void endElement(String uri, String localName, String qName) {
                capturePosFeatures = false; // we have all the features
                super.endElement(uri, localName, qName);
            }

        });

        // pos/feat element: contains a part of speech feature
        addHandler(&quot;pos/feat&quot;, new ElementHandler() {
            @Override
            public void startElement(String uri, String localName, String qName,
                    Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                if (capturePosFeatures) {
                    String featSubset = attributes.getValue(&quot;subset&quot;);
                    String featClass = attributes.getValue(&quot;class&quot;);
                    posFeatures.put(featSubset, featClass);
                }
            }
        });

        // t (token) element directly under w (word) element: contains the word form
        addHandler(&quot;w/t&quot;, new ContentCapturingHandler() {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L230">230</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerWhiteLab2.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerWhiteLab2.html#L362">362</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        addHandler(&quot;s&quot;, new InlineTagHandler());

        // Paragraph tags: index as tags in the content
        addHandler(&quot;p&quot;, new InlineTagHandler());

        // &lt;event/&gt; tags: index as tags in the content
        addHandler(&quot;event&quot;, new InlineTagHandler());

        // meta elements: metadata fields
        // [NOT USED FOR OPENSONAR..?]
        addHandler(&quot;meta&quot;, new ContentCapturingHandler() {

            private String metadataFieldName;

            /** Open tag: add metadata field */
            @Override
            public void startElement(String uri, String localName, String qName, Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                metadataFieldName = attributes.getValue(&quot;id&quot;);
            }

            @Override
            public void endElement(String uri, String localName, String qName) {
                super.endElement(uri, localName, qName);
                if (metadataFieldName != null)
                    addMetadataField(metadataFieldName, getElementContent());
            }
        });
    }

    public static void main(String[] args) {
        System.out.println(&quot;NL B&quot;.replaceAll(&quot;[\\s\\./]&quot;, &quot;_&quot;));
        System.out.println(&quot;NL/B&quot;.replaceAll(&quot;[\\s\\./]&quot;, &quot;_&quot;));
        System.out.println(&quot;a.b.c.d&quot;.replaceAll(&quot;[\\s\\./]&quot;, &quot;_&quot;));
    }

}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/lucene/SpanQuerySorted.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQuerySorted.html#L121">121</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/SpanQueryUnique.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQueryUnique.html#L128">128</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }

    @Override
    public boolean hitsAllSameLength() {
        return src.hitsAllSameLength();
    }

    @Override
    public int hitsLengthMin() {
        return src.hitsLengthMin();
    }

    @Override
    public int hitsLengthMax() {
        return src.hitsLengthMax();
    }

    @Override
    public boolean hitsStartPointSorted() {
        return true;
    }

    @Override
    public boolean hitsEndPointSorted() {
        return src.hitsEndPointSorted();
    }

    @Override
    public boolean hitsHaveUniqueStart() {
        return src.hitsHaveUniqueStart();
    }

    @Override
    public boolean hitsHaveUniqueEnd() {
        return src.hitsHaveUniqueEnd();
    }

    @Override
    public boolean hitsAreUnique() {
        return true;
    }

    @Override
    public long reverseMatchingCost(IndexReader reader) {
        return src.reverseMatchingCost(reader);
    }

    @Override
    public int forwardMatchingCost() {
        return src.forwardMatchingCost();
    }
    
    @Override
    public void setQueryInfo(QueryInfo queryInfo) {
        super.setQueryInfo(queryInfo);
        src.setQueryInfo(queryInfo);
    }
}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/testutil/BatchContentStore.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchContentStore.html#L70">70</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/testutil/BatchForwardIndex.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchForwardIndex.html#L63">63</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        System.err.println(&quot;done. [#docs: &quot; + cs.idSet().size() + &quot;]&quot;);

        System.out.println(&quot;First\tNumber\tSkip\tSnippets\tTime&quot;);

        for (String query : FileUtil.readLines(inputFile)) {
            query = query.trim();
            if (query.length() == 0 || query.charAt(0) == '#')
                continue; // skip empty lines and #-comments
            String[] numberStr = query.split(&quot;\\s+&quot;);
            int[] numbers = new int[numberStr.length];
            try {
                for (int i = 0; i &lt; numberStr.length; i++) {
                    numbers[i] = Integer.parseInt(numberStr[i]);
                }

                int first = numbers[0];
                int number = numbers.length &gt; 1 ? numbers[1] : 100;
                int skip = numbers.length &gt; 2 ? numbers[2] : 0;
                int snippets = numbers.length &gt; 3 ? numbers[3] : 5;
                long time = doPerformanceTest(cs, first, number, skip, snippets);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/lucene/SpanQueryFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQueryFiltered.html#L71">71</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/SpanQueryPositionFilter.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQueryPositionFilter.html#L235">235</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        return new SpanQueryFiltered(clauses.get(0).noEmpty(), filter);
    }

    @Override
    public boolean hitsAllSameLength() {
        return clauses.get(0).hitsAllSameLength();
    }

    @Override
    public int hitsLengthMin() {
        return clauses.get(0).hitsLengthMin();
    }

    @Override
    public int hitsLengthMax() {
        return clauses.get(0).hitsLengthMax();
    }

    @Override
    public boolean hitsStartPointSorted() {
        return true;
    }

    @Override
    public boolean hitsEndPointSorted() {
        return clauses.get(0).hitsEndPointSorted();
    }

    @Override
    public boolean hitsHaveUniqueStart() {
        return clauses.get(0).hitsHaveUniqueStart();
    }

    @Override
    public boolean hitsHaveUniqueEnd() {
        return clauses.get(0).hitsHaveUniqueEnd();
    }

    @Override
    public boolean hitsAreUnique() {
        return clauses.get(0).hitsAreUnique();
    }

    @Override
    public BLSpanWeight createWeight(IndexSearcher searcher, boolean needsScores) throws IOException {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/MetadataFetcherCgnImdi.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/MetadataFetcherCgnImdi.html#L114">114</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/MetadataFetcherSonarCmdi.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/MetadataFetcherSonarCmdi.html#L110">110</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        docIndexer.addMetadataField(&quot;AudioWebPlayFormat&quot;, &quot;mp3&quot;);

        try {
            InputStream is;
            if (metadataZipFile != null) {
                ZipEntry e = metadataZipFile.getEntry(metadataPathInZip + metadataFile);
                if (e == null) {
                    System.err.println(&quot;*** ERROR, metadata entry not found: &quot; + metadataPathInZip + metadataFile);
                    return;
                }
                is = metadataZipFile.getInputStream(e);
            } else {
                File f = new File(new File(metadataDir, metadataPathInZip), metadataFile);
                is = new FileInputStream(f);
            }

            ByteArrayOutputStream cmdiBuffer = new ByteArrayOutputStream(INITIAL_CMDI_BYTEBUFFER_SIZE);
            is = new TeeInputStream(is, cmdiBuffer);
            try (BufferedReader reader = new BufferedReader(
                    new InputStreamReader(is, Indexer.DEFAULT_INPUT_ENCODING))) {
                SAXParserFactory factory = SAXParserFactory.newInstance();
                factory.setNamespaceAware(true);
                SAXParser parser;
                parser = factory.newSAXParser();
                parser.parse(new InputSource(reader), new MetadataParser());
            } catch (SAXException | ParserConfigurationException e) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchCollocationsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchCollocationsFiltered.html#L29">29</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchDocGroupsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocGroupsFiltered.html#L26">26</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchDocsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocsFiltered.html#L25">25</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchHitGroupsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitGroupsFiltered.html#L28">28</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchHitsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitsFiltered.html#L24">24</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    protected TermFrequencyList executeInternal() throws InvalidQuery {
        return source.execute().filter(property, value);
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = super.hashCode();
        result = prime * result + ((property == null) ? 0 : property.hashCode());
        result = prime * result + ((source == null) ? 0 : source.hashCode());
        result = prime * result + ((value == null) ? 0 : value.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (!super.equals(obj))
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/testutil/BatchContentStore.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchContentStore.html#L31">31</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/testutil/BatchQuery.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchQuery.html#L32">32</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                } else {
                    System.err.println(&quot;Illegal option: &quot; + arg);
                    usage();
                    return;
                }
            } else {
                switch (fileArgNumber) {
                case 0:
                    indexDir = new File(arg);
                    if (!indexDir.exists() || !indexDir.isDirectory()) {
                        System.err.println(&quot;Index directory not found: &quot; + arg);
                        usage();
                        return;
                    }
                    break;
                case 1:
                    inputFile = new File(arg);
                    if (!inputFile.exists()) {
                        System.err.println(&quot;Input file not found: &quot; + arg);
                        usage();
                        return;
                    }
                    break;
                default:
                    System.err.println(&quot;Too many file arguments (supply index dir and input file)&quot;);
                    usage();
                    return;
                }
                fileArgNumber++;
            }
        }
        if (fileArgNumber &lt; 2) {
            System.err.println(&quot;Too few file arguments (supply index dir and input file)&quot;);
            usage();
            return;
        }

        System.err.print(&quot;Opening content store... &quot;);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/contentstore/ContentStoreDirUtf8.java</td>
<td><a href="./xref/nl/inl/blacklab/contentstore/ContentStoreDirUtf8.html#L709">709</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/contentstore/ContentStoreFixedBlockReader.java</td>
<td><a href="./xref/nl/inl/blacklab/contentstore/ContentStoreFixedBlockReader.html#L134">134</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            try (FileInputStream fileInputStream = new FileInputStream(getContentFile(e.fileId))) {
                try (FileChannel fileChannel = fileInputStream.getChannel()) {
                    // Retrieve the strings requested
                    for (int i = 0; i &lt; n; i++) {
                        int a = start[i];
                        int b = end[i];

                        if (a == -1)
                            a = 0;
                        if (b == -1)
                            b = e.entryLengthCharacters;

                        // Check values
                        if (a &lt; 0 || b &lt; 0) {
                            throw new IllegalArgumentException(&quot;Illegal values, start = &quot; + a + &quot;, end = &quot; + b);
                        }
                        if (a &gt; e.entryLengthCharacters || b &gt; e.entryLengthCharacters) {
                            throw new IllegalArgumentException(&quot;Value(s) out of range, start = &quot; + a
                                    + &quot;, end = &quot; + b + &quot;, content length = &quot; + e.entryLengthCharacters);
                        }
                        if (b &lt;= a) {
                            throw new IllegalArgumentException(
                                    &quot;Tried to read empty or negative length snippet (from &quot; + a
                                            + &quot; to &quot; + b + &quot;)&quot;);
                        }

                        // 1 - determine what blocks to read
                        int firstBlock = a / e.blockSizeCharacters;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/search/fimatch/NfaStateAndAcyclic.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateAndAcyclic.html#L72">72</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/search/fimatch/NfaStateOrAcyclic.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateOrAcyclic.html#L83">83</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        NfaStateAndAcyclic copy = new NfaStateAndAcyclic();
        copiesMade.put(this, copy);
        List&lt;NfaState&gt; clauseCopies = new ArrayList&lt;&gt;();
        for (NfaState clause : clauses) {
            clause = clause.copy(null, copiesMade);
            clauseCopies.add(clause);
        }
        copy.clauses.addAll(clauseCopies);
        copy.nextState = nextState;
        if (nextState == null &amp;&amp; dangling != null)
            dangling.add(copy);
        return copy;
    }

    @Override
    public void setNextState(int input, NfaState state) {
        clauses.set(input, state);
    }

    @Override
    public boolean matchesEmptySequence(Set&lt;NfaState&gt; statesVisited) {
        if (statesVisited.contains(this)) {
            // We've found a cycle. Stop processing, and just return the
            // &quot;safest&quot; (least-guarantee) answer. In this case: we can't
            // guarantee that this DOESN'T match the empty sequence.
            return true;
        }
        statesVisited.add(this);</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterAnd.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterAnd.html#L40">40</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterImplication.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterImplication.html#L40">40</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        MatchFilterAnd other = (MatchFilterAnd) obj;
        if (a == null) {
            if (other.a != null)
                return false;
        } else if (!a.equals(other.a))
            return false;
        if (b == null) {
            if (other.b != null)
                return false;
        } else if (!b.equals(other.b))
            return false;
        return true;
    }

    @Override
    public void setHitQueryContext(HitQueryContext context) {
        a.setHitQueryContext(context);
        b.setHitQueryContext(context);
    }

    @Override
    public ConstraintValue evaluate(ForwardIndexDocument fiDoc, Span[] capturedGroups) {
        ConstraintValue ra = a.evaluate(fiDoc, capturedGroups);
        if (!ra.isTruthy())
            return ra;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchCollocationsSampled.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchCollocationsSampled.html#L24">24</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchDocGroupsSampled.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocGroupsSampled.html#L22">22</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchDocsSampled.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocsSampled.html#L21">21</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchHitGroupsSampled.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitGroupsSampled.html#L24">24</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchHitsSampled.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitsSampled.html#L21">21</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    protected TermFrequencyList executeInternal() throws InvalidQuery {
        return source.execute().sample(sampleParameters);
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = super.hashCode();
        result = prime * result + ((sampleParameters == null) ? 0 : sampleParameters.hashCode());
        result = prime * result + ((source == null) ? 0 : source.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (!super.equals(obj))
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchCollocationsSorted.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchCollocationsSorted.html#L24">24</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchDocGroupsSorted.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocGroupsSorted.html#L22">22</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchDocsSorted.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocsSorted.html#L21">21</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchHitGroupsSorted.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitGroupsSorted.html#L25">25</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchHitsSorted.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitsSorted.html#L21">21</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    protected TermFrequencyList executeInternal() throws InvalidQuery {
        return source.execute().sort(property);
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = super.hashCode();
        result = prime * result + ((property == null) ? 0 : property.hashCode());
        result = prime * result + ((source == null) ? 0 : source.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (!super.equals(obj))
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchCollocationsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchCollocationsFiltered.html#L51">51</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchDocGroupsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocGroupsFiltered.html#L48">48</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchDocsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocsFiltered.html#L47">47</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchHitGroupsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitGroupsFiltered.html#L50">50</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchHitsFiltered.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitsFiltered.html#L46">46</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        SearchCollocationsFiltered other = (SearchCollocationsFiltered) obj;
        if (property == null) {
            if (other.property != null)
                return false;
        } else if (!property.equals(other.property))
            return false;
        if (source == null) {
            if (other.source != null)
                return false;
        } else if (!source.equals(other.source))
            return false;
        if (value == null) {
            if (other.value != null)
                return false;
        } else if (!value.equals(other.value))
            return false;
        return true;
    }
    
    @Override
    public String toString() {
        return toString(&quot;filter&quot;, source, property, value);
    }
}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchCollocationsWindow.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchCollocationsWindow.html#L24">24</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchDocGroupsWindow.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocGroupsWindow.html#L22">22</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchDocsWindow.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchDocsWindow.html#L23">23</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/searches/SearchHitGroupsWindow.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitGroupsWindow.html#L24">24</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/searches/SearchHitsWindow.java</td>
<td><a href="./xref/nl/inl/blacklab/searches/SearchHitsWindow.html#L22">22</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    protected TermFrequencyList executeInternal() throws InvalidQuery {
        return source.execute().window(first, number);
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = super.hashCode();
        result = prime * result + first;
        result = prime * result + number;
        result = prime * result + ((source == null) ? 0 : source.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (!super.equals(obj))
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterAnd.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterAnd.html#L40">40</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterImplication.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterImplication.html#L40">40</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterOr.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterOr.html#L40">40</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        MatchFilterAnd other = (MatchFilterAnd) obj;
        if (a == null) {
            if (other.a != null)
                return false;
        } else if (!a.equals(other.a))
            return false;
        if (b == null) {
            if (other.b != null)
                return false;
        } else if (!b.equals(other.b))
            return false;
        return true;
    }

    @Override
    public void setHitQueryContext(HitQueryContext context) {
        a.setHitQueryContext(context);
        b.setHitQueryContext(context);
    }

    @Override
    public ConstraintValue evaluate(ForwardIndexDocument fiDoc, Span[] capturedGroups) {
        ConstraintValue ra = a.evaluate(fiDoc, capturedGroups);
        if (!ra.isTruthy())</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/MetadataFetcherCgnImdi.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/MetadataFetcherCgnImdi.html#L48">48</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/MetadataFetcherSonarCmdi.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/MetadataFetcherSonarCmdi.html#L48">48</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>public class MetadataFetcherCgnImdi extends MetadataFetcher {

    private static final int INITIAL_CMDI_BYTEBUFFER_SIZE = 1000;

    @SuppressWarnings(&quot;deprecation&quot;)
    private static void init(DocIndexer docIndexer) {
        String zipFilePath = docIndexer.getParameter(&quot;metadataZipFile&quot;);
        if (zipFilePath == null) {
            zipFilePath = docIndexer.getParameter(&quot;metadataDir&quot;);
            if (zipFilePath == null)
                throw new BlackLabRuntimeException(
                        &quot;For OpenSonar metadata, specify metadataZipFile or metadataDir in indexer.properties!&quot;);
            metadataDir = new File(zipFilePath);
        } else {
            try {
                metadataZipFile = new ZipFile(new File(zipFilePath));
            } catch (IOException e) {
                throw BlackLabRuntimeException.wrap(e);
            }
        }
    }

    static private ZipFile metadataZipFile = null;

    static private File metadataDir = null;

    private String metadataPathInZip;

    @SuppressWarnings(&quot;deprecation&quot;)
    public MetadataFetcherCgnImdi(DocIndexer docIndexer) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/analysis/RemoveAllAccentsFilter.java</td>
<td><a href="./xref/nl/inl/blacklab/analysis/RemoveAllAccentsFilter.html#L51">51</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/analysis/RemovePunctuationFilter.java</td>
<td><a href="./xref/nl/inl/blacklab/analysis/RemovePunctuationFilter.html#L65">65</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            t = StringUtil.stripAccents(t);
            termAtt.copyBuffer(t.toCharArray(), 0, t.length());
            return true;
        }
        return false;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = super.hashCode();
        result = prime * result + ((termAtt == null) ? 0 : termAtt.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (!super.equals(obj))
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/lucene/BLSpanMultiTermQueryWrapper.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/BLSpanMultiTermQueryWrapper.html#L94">94</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/BLSpanTermQuery.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/BLSpanTermQuery.html#L141">141</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            BLSpanMultiTermQueryWrapper&lt;?&gt; other = (BLSpanMultiTermQueryWrapper&lt;?&gt;) obj;
            return query.equals(other.query);
        }
        return false;
    }

    @Override
    public boolean hitsAllSameLength() {
        return true;
    }

    @Override
    public int hitsLengthMin() {
        return 1;
    }

    @Override
    public int hitsLengthMax() {
        return 1;
    }

    @Override
    public boolean hitsEndPointSorted() {
        return true;
    }

    @Override
    public boolean hitsStartPointSorted() {
        return true;
    }

    @Override
    public boolean hitsHaveUniqueStart() {
        return true;
    }

    @Override
    public boolean hitsHaveUniqueEnd() {
        return true;
    }

    @Override
    public boolean hitsAreUnique() {
        return true;
    }

    @Override
    public Nfa getNfa(ForwardIndexAccessor fiAccessor, int direction) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/contentstore/ContentStoreDirUtf8.java</td>
<td><a href="./xref/nl/inl/blacklab/contentstore/ContentStoreDirUtf8.html#L421">421</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/contentstore/ContentStoreFixedBlockWriter.java</td>
<td><a href="./xref/nl/inl/blacklab/contentstore/ContentStoreFixedBlockWriter.html#L202">202</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }

    private void writeToc() {
        try {
            mapToc(true);
            tocFileBuffer.putInt(toc.size());
            try {
                for (TocEntry e : toc.values()) {
                    if (tocFileBuffer.remaining() &lt; e.sizeBytes()) {
                        // Close and re-open with extra writing room
                        int p = tocFileBuffer.position();
                        closeMappedToc();
                        mapToc(true);
                        tocFileBuffer.position(p);
                    }
                    e.serialize(tocFileBuffer);
                }
            } finally {
                closeMappedToc();
            }
        } catch (IOException e) {
            throw BlackLabRuntimeException.wrap(e);
        }
        tocModified = false;
    }

    /**
     * Close the content store. Writes the table of contents (if modified)
     */
    @Override
    public void close() {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerFolia.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerFolia.html#L109">109</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L202">202</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            }
        });

        // t (token) element directly under w (word) element: contains the word form
        addHandler(&quot;w/t&quot;, new ContentCapturingHandler() {

            /**
             * Tokens with a class attribute are (usually?) the original scanned token
             * before correction, so we skip them
             */
            boolean isOcr;

            @Override
            public void startElement(String uri, String localName, String qName,
                    Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                isOcr = attributes.getValue(&quot;class&quot;) != null;
            }

            @Override
            public void endElement(String uri, String localName, String qName) {
                super.endElement(uri, localName, qName);
                if (!isOcr)
                    wordform = getElementContent();
            }
        });

        // Sentence tags: index as tags in the content
        addHandler(&quot;s&quot;, new InlineTagHandler());

        // Paragraph tags: index as tags in the content
        addHandler(&quot;p&quot;, new InlineTagHandler());

        // meta elements: metadata fields
        addHandler(&quot;meta&quot;, new ContentCapturingHandler() {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/fimatch/NfaStateAnd.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateAnd.html#L154">154</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/fimatch/NfaStateOr.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateOr.html#L155">155</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        return &quot;AND(&quot; + b.toString() + &quot;)&quot;;
    }

    @Override
    void lookupPropertyNumbersInternal(ForwardIndexAccessor fiAccessor, Map&lt;NfaState, Boolean&gt; statesVisited) {
        for (NfaState s : nextStates) {
            if (s != null)
                s.lookupPropertyNumbers(fiAccessor, statesVisited);
        }
    }

    @Override
    protected void finishInternal(Set&lt;NfaState&gt; visited) {
        for (int i = 0; i &lt; nextStates.size(); i++) {
            NfaState s = nextStates.get(i);
            if (s == null)
                nextStates.set(i, match());
            else
                s.finish(visited);
        }
    }

}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L146">146</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerWhiteLab2.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerWhiteLab2.html#L208">208</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                if (numLemmaAnnotations == 2 &amp;&amp; isFrog ||
                        numLemmaAnnotations == 1 &amp;&amp; isSetLess) {
                    // If there were 2 lemma annotation meta declarations,
                    // we should use the frog ones; if only 1, the ones
                    // without a &quot;set&quot; attribute.
                    lemma = attributes.getValue(&quot;class&quot;);
                    if (lemma == null)
                        lemma = &quot;&quot;;
                }
            }
        });

        // pos element: contains part of speech
        addHandler(&quot;pos&quot;, new ElementHandler() {
            @Override
            public void startElement(String uri, String localName, String qName,
                    Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                String set = attributes.getValue(&quot;set&quot;);
                boolean isSetLess = set == null || set.length() == 0;
                boolean isFrog = !isSetLess &amp;&amp; set.equals(&quot;http://ilk.uvt.nl/folia/sets/frog-mbpos-cgn&quot;);
                if (numPosAnnotations == 2 &amp;&amp; isFrog ||</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/fimatch/NfaStateMultiTermPattern.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateMultiTermPattern.html#L98">98</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/fimatch/NfaStateToken.java</td>
<td><a href="./xref/nl/inl/blacklab/search/fimatch/NfaStateToken.html#L105">105</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    @Override
    public void setNextState(int i, NfaState state) {
        if (i != 0)
            throw new BlackLabRuntimeException(&quot;Token state only has one next state&quot;);
        nextState = state;
    }

    @Override
    public boolean matchesEmptySequence(Set&lt;NfaState&gt; statesVisited) {
        return false;
    }

    @Override
    public boolean hitsAllSameLength(Set&lt;NfaState&gt; statesVisited) {
        return true;
    }

    @Override
    public int hitsLengthMin(Set&lt;NfaState&gt; statesVisited) {
        return 1;
    }

    @Override
    public int hitsLengthMax(Set&lt;NfaState&gt; statesVisited) {
        return 1;
    }

    @Override
    protected String dumpInternal(Map&lt;NfaState, Integer&gt; stateNrs) {
        String name = getPatternType();</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/lucene/SpanQueryConstrained.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQueryConstrained.html#L108">108</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/SpanQueryPositionFilter.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQueryPositionFilter.html#L260">260</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        return clauses.get(0).hitsStartPointSorted();
    }

    @Override
    public boolean hitsHaveUniqueStart() {
        return clauses.get(0).hitsHaveUniqueStart();
    }

    @Override
    public boolean hitsHaveUniqueEnd() {
        return clauses.get(0).hitsHaveUniqueEnd();
    }

    @Override
    public boolean hitsAreUnique() {
        return clauses.get(0).hitsAreUnique();
    }

    @Override
    public long reverseMatchingCost(IndexReader reader) {
        return clauses.get(0).reverseMatchingCost(reader);
    }

    @Override
    public int forwardMatchingCost() {
        return clauses.get(0).forwardMatchingCost();
    }

    @Override
    public String getRealField() {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L75">75</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerWhiteLab2.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerWhiteLab2.html#L107">107</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        final AnnotationWriter propPartOfSpeech = addAnnotation(&quot;pos&quot;);

        registerContentsField();

        // Doc element: the individual documents to index
        addHandler(&quot;/FoLiA&quot;, new DocumentElementHandler());

        // PoS annotation metadata: see which annotation we need to use.
        addHandler(&quot;pos-annotation&quot;, new ElementHandler() {
            @Override
            public void startElement(String uri, String localName,
                    String qName, Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                numPosAnnotations++;
            }
        });

        // Lemma annotation metadata: see which annotation we need to use.
        addHandler(&quot;lemma-annotation&quot;, new ElementHandler() {
            @Override
            public void startElement(String uri, String localName,
                    String qName, Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                numLemmaAnnotations++;
            }
        });

        // Word elements: index as main contents
        addHandler(&quot;w&quot;, new WordHandlerBase() {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterAnd.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterAnd.html#L20">20</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterImplication.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterImplication.html#L20">20</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/search/matchfilter/MatchFilterOr.java</td>
<td><a href="./xref/nl/inl/blacklab/search/matchfilter/MatchFilterOr.html#L20">20</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        return a + &quot; &amp; &quot; + b;
    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((a == null) ? 0 : a.hashCode());
        result = prime * result + ((b == null) ? 0 : b.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerFolia.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerFolia.html#L109">109</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L202">202</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerWhiteLab2.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerWhiteLab2.html#L313">313</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            }
        });

        // t (token) element directly under w (word) element: contains the word form
        addHandler(&quot;w/t&quot;, new ContentCapturingHandler() {

            /**
             * Tokens with a class attribute are (usually?) the original scanned token
             * before correction, so we skip them
             */
            boolean isOcr;

            @Override
            public void startElement(String uri, String localName, String qName,
                    Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                isOcr = attributes.getValue(&quot;class&quot;) != null;
            }

            @Override
            public void endElement(String uri, String localName, String qName) {
                super.endElement(uri, localName, qName);
                if (!isOcr)
                    wordform = getElementContent();
            }
        });

        // Sentence tags: index as tags in the content
        addHandler(&quot;s&quot;, new InlineTagHandler());</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/mocks/MockAnnotation.java</td>
<td><a href="./xref/nl/inl/blacklab/mocks/MockAnnotation.html#L112">112</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/indexmetadata/AnnotationImpl.java</td>
<td><a href="./xref/nl/inl/blacklab/search/indexmetadata/AnnotationImpl.html#L262">262</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }

    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((field == null) ? 0 : field.hashCode());
        result = prime * result + ((name == null) ? 0 : name.hashCode());
        return result;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerFolia.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerFolia.html#L140">140</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L236">236</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerWhiteLab2.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerWhiteLab2.html#L368">368</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        addHandler(&quot;p&quot;, new InlineTagHandler());

        // meta elements: metadata fields
        addHandler(&quot;meta&quot;, new ContentCapturingHandler() {

            private String metadataFieldName;

            /** Open tag: add metadata field */
            @Override
            public void startElement(String uri, String localName, String qName, Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                metadataFieldName = attributes.getValue(&quot;id&quot;);
            }

            @Override
            public void endElement(String uri, String localName, String qName) {
                super.endElement(uri, localName, qName);
                if (metadataFieldName != null)
                    addMetadataField(metadataFieldName, getElementContent());
            }
        });
    }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/MetadataFetcherCgnImdi.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/MetadataFetcherCgnImdi.html#L182">182</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/MetadataFetcherSonarCmdi.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/MetadataFetcherSonarCmdi.html#L202">202</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            elementStack.remove(elementStack.size() - 1);
        }

        public MetadataParser() {
            indexFieldAs.put(&quot;iso-639-3-code&quot;, &quot;Language-iso-code&quot;);
            indexFieldAs.put(&quot;Name&quot;, &quot;AuthorName&quot;);
        }

        @Override
        public void startElement(String uri, String localName, String qName, Attributes attributes) {
            stackPush(localName);
            hasChild = false; // we haven't seen a child for this element yet
            textContent.setLength(0); // clear buffer
        }

        @Override
        public void endElement(String uri, String localName, String qName) {

            if (!hasChild) {
                // See if we captured any text content
                String content = textContent.toString().trim();
                if (content.length() &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/BLSpanMultiTermQueryWrapper.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/BLSpanMultiTermQueryWrapper.html#L98">98</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/search/lucene/BLSpanTermQuery.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/BLSpanTermQuery.html#L145">145</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/SpanQueryNot.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpanQueryNot.html#L135">135</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }

    @Override
    public boolean hitsAllSameLength() {
        return true;
    }

    @Override
    public int hitsLengthMin() {
        return 1;
    }

    @Override
    public int hitsLengthMax() {
        return 1;
    }

    @Override
    public boolean hitsEndPointSorted() {
        return true;
    }

    @Override
    public boolean hitsStartPointSorted() {
        return true;
    }

    @Override
    public boolean hitsHaveUniqueStart() {
        return true;
    }

    @Override
    public boolean hitsHaveUniqueEnd() {
        return true;
    }

    @Override
    public boolean hitsAreUnique() {
        return true;
    }

    @Override
    public Nfa getNfa(ForwardIndexAccessor fiAccessor, int direction) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/search/lucene/SpansPositionFilter.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpansPositionFilter.html#L248">248</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/search/lucene/SpansPositionFilter.java</td>
<td><a href="./xref/nl/inl/blacklab/search/lucene/SpansPositionFilter.html#L306">306</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            case CONTAINING:
                // Looking for producer hits with a filter hit inside
                while (min &lt;= max) {
                    int i = (min + max) / 2;
                    if (filterFixedLength &amp;&amp; filter.endPosition(i) &gt; producer.endPosition() + rightAdjust) {
                        // Filter end position to the right of producer hit end position.
                        max = i - 1;
                    } else if (filter.startPosition(i) &lt; producerStart + leftAdjust) {
                        // Filter start position to the left of producer hit start position.
                        min = i + 1;
                    } else {
                        // Can't narrow down the edges any further; do linear search from here.
                        break;
                    }
                }
                for (int i = min; i &lt;= max; i++) {
                    if (filter.startPosition(i) &gt;= producerStart + leftAdjust
                            &amp;&amp; filter.endPosition(i) &lt;= producer.endPosition() + rightAdjust) {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>nl/inl/blacklab/testutil/BatchContentStore.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchContentStore.html#L37">37</a></td></tr>
<tr class="a">
<td>nl/inl/blacklab/testutil/BatchForwardIndex.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchForwardIndex.html#L31">31</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/testutil/BatchQuery.java</td>
<td><a href="./xref/nl/inl/blacklab/testutil/BatchQuery.html#L38">38</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                switch (fileArgNumber) {
                case 0:
                    indexDir = new File(arg);
                    if (!indexDir.exists() || !indexDir.isDirectory()) {
                        System.err.println(&quot;Index directory not found: &quot; + arg);
                        usage();
                        return;
                    }
                    break;
                case 1:
                    inputFile = new File(arg);
                    if (!inputFile.exists()) {
                        System.err.println(&quot;Input file not found: &quot; + arg);
                        usage();
                        return;
                    }
                    break;
                default:
                    System.err.println(&quot;Too many file arguments (supply index dir and input file)&quot;);
                    usage();
                    return;
                }
                fileArgNumber++;
            }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>nl/inl/blacklab/indexers/DocIndexerFolia.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerFolia.html#L62">62</a></td></tr>
<tr class="b">
<td>nl/inl/blacklab/indexers/DocIndexerOpenSonar.java</td>
<td><a href="./xref/nl/inl/blacklab/indexers/DocIndexerOpenSonar.html#L100">100</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        addHandler(&quot;/FoLiA&quot;, new DocumentElementHandler());

        // Word elements: index as main contents
        addHandler(&quot;w&quot;, new WordHandlerBase() {

            @Override
            public void startElement(String uri, String localName, String qName,
                    Attributes attributes) {
                super.startElement(uri, localName, qName, attributes);
                wordform = &quot;&quot;;
                pos = &quot;&quot;;
                lemma = &quot;&quot;;
            }

            @Override
            public void endElement(String uri, String localName, String qName) {
                super.endElement(uri, localName, qName);
                if (wordform.length() &gt; 0) {
                    propMain.addValue(wordform);
                    propPartOfSpeech.addValue(pos);</pre></div></td></tr></table></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2020
<a href="https://www.ivdnt.org/">Instituut voor Nederlandse Taal (INT)</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
